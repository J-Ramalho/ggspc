<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="4.7 The 2^3 Factorial Design | industRial data science" />
<meta property="og:type" content="book" />


<meta property="og:description" content="The output format is bookdown::bookdown_site." />


<meta name="author" content="João Ramalho" />

<meta name="date" content="2021-01-20" />


<meta name="description" content="The output format is bookdown::bookdown_site.">

<title>4.7 The 2^3 Factorial Design | industRial data science</title>

<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="libs/navigation-1.1/tabsets.js"></script>




<link rel="stylesheet" href="style.css" type="text/css" />

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
</style>
</head>

<body>

<div class="container-fluid main-container">


<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li><a href="index.html#introduction">Introduction</a></li>
<li class="part"><span><b>I FRAMEWORK</b></span></li>
<li><a href="1-dfss-design-for-six-sigma.html#dfss---design-for-six-sigma"><span class="toc-section-number">1</span> DFSS - Design for Six Sigma</a></li>
<li><a href="2-statistics.html#statistics"><span class="toc-section-number">2</span> Statistics</a></li>
<li><a href="3-r-and-data-science.html#r-and-data-science"><span class="toc-section-number">3</span> R and Data Science</a>
<ul>
<li><a href="3-1-why-r.html#why-r"><span class="toc-section-number">3.1</span> Why R</a></li>
<li><a href="3-2-usefull-packages.html#usefull-packages"><span class="toc-section-number">3.2</span> Usefull packages</a></li>
</ul></li>
<li class="part"><span><b>II CASE STUDIES</b></span></li>
<li><a href="4-DOE.html#DOE"><span class="toc-section-number">4</span> DOE - Design of Experiments</a>
<ul>
<li><a href="4-1-simple-comparative-experiments.html#simple-comparative-experiments"><span class="toc-section-number">4.1</span> Simple comparative experiments</a>
<ul>
<li><a href="4-1-simple-comparative-experiments.html#the-cement-example"><span class="toc-section-number">4.1.1</span> The Cement example</a></li>
<li><a href="4-1-simple-comparative-experiments.html#homogeneity-of-variances-test-levene-test"><span class="toc-section-number">4.1.2</span> Homogeneity of variances test (Levene Test)</a></li>
<li><a href="4-1-simple-comparative-experiments.html#sample-size-calculation"><span class="toc-section-number">4.1.3</span> Sample size calculation</a></li>
<li><a href="4-1-simple-comparative-experiments.html#t-test-paired"><span class="toc-section-number">4.1.4</span> t-test paired</a></li>
</ul></li>
<li><a href="4-2-single-factor-designs.html#single-factor-designs"><span class="toc-section-number">4.2</span> Single factor designs</a>
<ul>
<li><a href="4-2-single-factor-designs.html#plasma-etching-example"><span class="toc-section-number">4.2.1</span> Plasma etching example</a></li>
<li><a href="4-2-single-factor-designs.html#analysis-of-variance"><span class="toc-section-number">4.2.2</span> Analysis of variance</a></li>
<li><a href="4-2-single-factor-designs.html#single-factor-anova-fixed-effects-model"><span class="toc-section-number">4.2.3</span> Single factor Anova, fixed effects model</a></li>
<li><a href="4-2-single-factor-designs.html#model-adequacy-check"><span class="toc-section-number">4.2.4</span> Model adequacy check</a></li>
<li><a href="4-2-single-factor-designs.html#residuals-normality-check-outliers"><span class="toc-section-number">4.2.5</span> Residuals normality check &amp; outliers</a></li>
<li><a href="4-2-single-factor-designs.html#plot-of-residuals-in-time-sequence"><span class="toc-section-number">4.2.6</span> Plot of residuals in time sequence</a></li>
<li><a href="4-2-single-factor-designs.html#plot-of-residuals-versus-fitted-values"><span class="toc-section-number">4.2.7</span> Plot of residuals versus fitted values</a></li>
<li><a href="4-2-single-factor-designs.html#equality-of-variances-test-barletts-test"><span class="toc-section-number">4.2.8</span> Equality of variances test (Barlett’s test)</a></li>
<li><a href="4-2-single-factor-designs.html#tuckeys-pairwise-comparison-test"><span class="toc-section-number">4.2.9</span> Tuckey’s pairwise comparison test</a></li>
<li><a href="4-2-single-factor-designs.html#fishers-lsd---pairwise-comparison-test"><span class="toc-section-number">4.2.10</span> Fisher’s LSD - pairwise comparison test</a></li>
<li><a href="4-2-single-factor-designs.html#practical-interpretation-of-results"><span class="toc-section-number">4.2.11</span> Practical interpretation of results</a></li>
<li><a href="4-2-single-factor-designs.html#linear-model"><span class="toc-section-number">4.2.12</span> Linear model</a></li>
<li><a href="4-2-single-factor-designs.html#linear-model-plot"><span class="toc-section-number">4.2.13</span> Linear model plot</a></li>
<li><a href="4-2-single-factor-designs.html#predicting-new-values"><span class="toc-section-number">4.2.14</span> Predicting new values</a></li>
<li><a href="4-2-single-factor-designs.html#r²-coefficient-of-determination"><span class="toc-section-number">4.2.15</span> R², coefficient of determination</a></li>
<li><a href="4-2-single-factor-designs.html#sample-size-calculation-1"><span class="toc-section-number">4.2.16</span> Sample size calculation</a></li>
</ul></li>
<li><a href="4-3-two-factors-anova-fixed-effects-model.html#two-factors-anova-fixed-effects-model"><span class="toc-section-number">4.3</span> two-factors ANOVA, fixed effects model</a>
<ul>
<li><a href="4-3-two-factors-anova-fixed-effects-model.html#battery-life-example"><span class="toc-section-number">4.3.1</span> Battery life example</a></li>
<li><a href="4-3-two-factors-anova-fixed-effects-model.html#analysis-of-variance-1"><span class="toc-section-number">4.3.2</span> Analysis of variance</a></li>
<li><a href="4-3-two-factors-anova-fixed-effects-model.html#doe-and-anova-plots"><span class="toc-section-number">4.3.3</span> DoE and Anova plots</a></li>
<li><a href="4-3-two-factors-anova-fixed-effects-model.html#r²-coefficient-of-determination-1"><span class="toc-section-number">4.3.4</span> R², coefficient of determination</a></li>
<li><a href="4-3-two-factors-anova-fixed-effects-model.html#model-adequacy-checking"><span class="toc-section-number">4.3.5</span> Model adequacy checking</a></li>
<li><a href="4-3-two-factors-anova-fixed-effects-model.html#residuals-normality-check-outliers-1"><span class="toc-section-number">4.3.6</span> Residuals normality check &amp; outliers</a></li>
<li><a href="4-3-two-factors-anova-fixed-effects-model.html#plot-of-residuals-versus-fitted-values-1"><span class="toc-section-number">4.3.7</span> Plot of residuals versus fitted values</a></li>
<li><a href="4-3-two-factors-anova-fixed-effects-model.html#sample-size-calculation-2"><span class="toc-section-number">4.3.8</span> Sample size calculation</a></li>
<li><a href="4-3-two-factors-anova-fixed-effects-model.html#model-with-no-interaction"><span class="toc-section-number">4.3.9</span> Model with no interaction</a></li>
</ul></li>
<li><a href="4-4-general-factorial-design.html#general-factorial-design"><span class="toc-section-number">4.4</span> General factorial design</a>
<ul>
<li><a href="4-4-general-factorial-design.html#soft-drink-bottling-example"><span class="toc-section-number">4.4.1</span> Soft Drink bottling example</a></li>
<li><a href="4-4-general-factorial-design.html#analysis-of-variance-2"><span class="toc-section-number">4.4.2</span> Analysis of variance</a></li>
<li><a href="4-4-general-factorial-design.html#residuals-analysis"><span class="toc-section-number">4.4.3</span> Residuals analysis</a></li>
<li><a href="4-4-general-factorial-design.html#doe-plots"><span class="toc-section-number">4.4.4</span> DoE plots</a></li>
</ul></li>
<li><a href="4-5-the-2k-factorial-designs.html#the-2k-factorial-designs"><span class="toc-section-number">4.5</span> The 2^k factorial designs</a></li>
<li><a href="4-6-the-22-factorial-design.html#the-22-factorial-design"><span class="toc-section-number">4.6</span> The 2^2 Factorial Design</a>
<ul>
<li><a href="4-6-the-22-factorial-design.html#the-chemical-process-example"><span class="toc-section-number">4.6.1</span> The Chemical Process example</a></li>
<li><a href="4-6-the-22-factorial-design.html#anova"><span class="toc-section-number">4.6.2</span> Anova</a></li>
<li><a href="4-6-the-22-factorial-design.html#regression-model-prediction"><span class="toc-section-number">4.6.3</span> Regression model / Prediction</a></li>
<li><a href="4-6-the-22-factorial-design.html#response-surface"><span class="toc-section-number">4.6.4</span> Response surface</a></li>
</ul></li>
<li><a href="4-7-the-23-factorial-design.html#the-23-factorial-design"><span class="toc-section-number">4.7</span> The 2^3 Factorial Design</a>
<ul>
<li><a href="4-7-the-23-factorial-design.html#the-plasma-etching-example"><span class="toc-section-number">4.7.1</span> The plasma etching example</a></li>
<li><a href="4-7-the-23-factorial-design.html#anova-1"><span class="toc-section-number">4.7.2</span> Anova</a></li>
<li><a href="4-7-the-23-factorial-design.html#regression-model-prediction-1"><span class="toc-section-number">4.7.3</span> Regression model / Prediction</a></li>
<li><a href="4-7-the-23-factorial-design.html#reduced-model"><span class="toc-section-number">4.7.4</span> Reduced model</a></li>
<li><a href="4-7-the-23-factorial-design.html#doe-plots-1"><span class="toc-section-number">4.7.5</span> DoE plots</a></li>
</ul></li>
<li><a href="4-8-the-general-2k-design.html#the-general-2k-design"><span class="toc-section-number">4.8</span> The general 2^k design</a>
<ul>
<li><a href="4-8-the-general-2k-design.html#calculating-the-number-combinations"><span class="toc-section-number">4.8.1</span> Calculating the number combinations</a></li>
<li><a href="4-8-the-general-2k-design.html#relationship-coded-vs-natural-variables"><span class="toc-section-number">4.8.2</span> Relationship coded vs natural variables</a></li>
</ul></li>
<li><a href="4-9-single-replicate-2k-design.html#single-replicate-2k-design"><span class="toc-section-number">4.9</span> Single replicate 2^k design</a>
<ul>
<li><a href="4-9-single-replicate-2k-design.html#the-filtration-example"><span class="toc-section-number">4.9.1</span> The Filtration example</a></li>
<li><a href="4-9-single-replicate-2k-design.html#anova-2"><span class="toc-section-number">4.9.2</span> Anova</a></li>
<li><a href="4-9-single-replicate-2k-design.html#linear-regression---plot-of-effects"><span class="toc-section-number">4.9.3</span> Linear regression - Plot of effects</a></li>
<li><a href="4-9-single-replicate-2k-design.html#doe-plots-2"><span class="toc-section-number">4.9.4</span> DoE plots</a></li>
<li><a href="4-9-single-replicate-2k-design.html#anova-reduced-model-significant-effects-only"><span class="toc-section-number">4.9.5</span> Anova reduced model (significant effects only)</a></li>
<li><a href="4-9-single-replicate-2k-design.html#linear-regression---reduced-model"><span class="toc-section-number">4.9.6</span> Linear regression - reduced model</a></li>
<li><a href="4-9-single-replicate-2k-design.html#residuals-normality-check"><span class="toc-section-number">4.9.7</span> Residuals normality check</a></li>
</ul></li>
<li><a href="4-10-two-level-fractional-factorial-designs.html#two-level-fractional-factorial-designs"><span class="toc-section-number">4.10</span> Two level fractional factorial designs</a>
<ul>
<li><a href="4-10-two-level-fractional-factorial-designs.html#the-one-half-fraction-of-th-2k-design"><span class="toc-section-number">4.10.1</span> The One-Half Fraction of th 2k Design</a></li>
<li><a href="4-10-two-level-fractional-factorial-designs.html#the-filtration-example-modified"><span class="toc-section-number">4.10.2</span> The filtration example (modified)</a></li>
<li><a href="4-10-two-level-fractional-factorial-designs.html#anova-3"><span class="toc-section-number">4.10.3</span> Anova</a></li>
</ul></li>
</ul></li>
<li><a href="5-MSA.html#MSA"><span class="toc-section-number">5</span> MSA - Measurement System Analysis</a></li>
<li><a href="6-SPC.html#SPC"><span class="toc-section-number">6</span> SPC - Statistical Process Control</a>
<ul>
<li><a href="6-1-xbar-and-r-charts.html#xbar-and-r-charts"><span class="toc-section-number">6.1</span> xbar and R charts</a></li>
</ul></li>
<li class="part"><span><b>III TOOLBOX</b></span></li>
<li><a href="7-Rpck.html#Rpck"><span class="toc-section-number">7</span> R Packages</a>
<ul>
<li><a href="7-1-six-sigma.html#six-sigma"><span class="toc-section-number">7.1</span> six sigma</a></li>
<li><a href="7-2-ggspc.html#ggspc"><span class="toc-section-number">7.2</span> ggspc</a></li>
<li><a href="7-3-qcc.html#qcc"><span class="toc-section-number">7.3</span> qcc</a></li>
</ul></li>
<li><a href="about-the-authors.html#about-the-authors">About the authors</a></li>
<li><a href="references.html#references">References</a></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="the-23-factorial-design" class="section level2" number="4.7">
<h2><span class="header-section-number">4.7</span> The 2^3 Factorial Design</h2>
<p>6.3.</p>
<div id="the-plasma-etching-example" class="section level3" number="4.7.1">
<h3><span class="header-section-number">4.7.1</span> The plasma etching example</h3>
<p>A - gap in cm
B - flow
C - power in W
response - etch rate in Angstrom/m</p>
<pre class="r"><code>pls &lt;- read.csv(paste0(working_folder, &quot;6-3 plasma.csv&quot;))
pls$A &lt;- as.factor(pls$A)
pls$B &lt;- as.factor(pls$B)
pls$C &lt;- as.factor(pls$C)

# Converting into a narrow table with a factor for utilisation with ggplot2
# syntax: gather(data, 
#               name of the new key column (where the columns names go to), 
#               name of the new value column (where the values go), 
#               name of the columns to be gathered)
plsn &lt;- pls %&gt;% # &quot;chm narrow dataframe&quot;
  gather(replicate, etch, Rep1, Rep2)</code></pre>
</div>
<div id="anova-1" class="section level3" number="4.7.2">
<h3><span class="header-section-number">4.7.2</span> Anova</h3>
<pre class="r"><code>plsn_lm &lt;- lm(etch ~ A * B * C, plsn)
plsn_aov &lt;- aov(plsn_lm)
summary(plsn_aov)</code></pre>
<pre><code>##             Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## A            1  41311   41311  18.339 0.002679 ** 
## B            1    218     218   0.097 0.763911    
## C            1 374850  374850 166.411 1.23e-06 ***
## A:B          1   2475    2475   1.099 0.325168    
## A:C          1  94403   94403  41.909 0.000193 ***
## B:C          1     18      18   0.008 0.930849    
## A:B:C        1    127     127   0.056 0.818586    
## Residuals    8  18020    2253                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Note here again that the Anova is performed on a model built with the treatments coded as factors, while later the prediction linear model is built with the treatments codes as numeric.
The main effects of Gap and Power are highly significant (both have very small P-values). The AC interaction is also highly significant; thus, there is a strong interaction between Gap and Power.</p>
</div>
<div id="regression-model-prediction-1" class="section level3" number="4.7.3">
<h3><span class="header-section-number">4.7.3</span> Regression model / Prediction</h3>
<pre class="r"><code># Below the adaptation of the chapter 6.2 approach in converting the factors into numeric, here with tidyverse functions:
plsn2 &lt;- plsn
plsn2 &lt;- plsn %&gt;% mutate(cA = ifelse(A == &quot;-1&quot;, -1, 1),
                         cB = ifelse(B == &quot;-1&quot;, -1, 1),
                         cC = ifelse(C == &quot;-1&quot;, -1, 1)
                         )



plsn2_lm &lt;- lm(etch ~ cA * cB * cC, plsn2)
summary(plsn2_lm)</code></pre>
<pre><code>## 
## Call:
## lm(formula = etch ~ cA * cB * cC, data = plsn2)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -65.50 -11.12   0.00  11.12  65.50 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  776.062     11.865  65.406 3.32e-12 ***
## cA           -50.812     11.865  -4.282 0.002679 ** 
## cB             3.688     11.865   0.311 0.763911    
## cC           153.062     11.865  12.900 1.23e-06 ***
## cA:cB        -12.437     11.865  -1.048 0.325168    
## cA:cC        -76.812     11.865  -6.474 0.000193 ***
## cB:cC         -1.062     11.865  -0.090 0.930849    
## cA:cB:cC       2.813     11.865   0.237 0.818586    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 47.46 on 8 degrees of freedom
## Multiple R-squared:  0.9661, Adjusted R-squared:  0.9364 
## F-statistic: 32.56 on 7 and 8 DF,  p-value: 2.896e-05</code></pre>
<pre class="r"><code># Predict new values
plsn_new &lt;- data.frame(cA = -1, cB = 1, cC = 1)
predict(plsn2_lm, newdata = plsn_new)</code></pre>
<pre><code>##    1 
## 1069</code></pre>
<pre class="r"><code># Compare with predicted table below (the same values are found!)
plsn2_tidy &lt;- augment(plsn2_lm)</code></pre>
<p>The linear model coeficients obtained correspond to the book example.
The predict function correctly corresponds to the predictions obtained with the augment function.</p>
<p>The ordinary R^2 is 0.9661 and it measures the proportion of total variability explained by the model. A potential problem with this statistic is that it always increases as factors are added to the model, even if these factors are not significant. The adjusted R^2 is obtained by dividing the Sums of Squares by the degrees of freedom, and is adjusted for the size of the model, that is the number of factors.</p>
</div>
<div id="reduced-model" class="section level3" number="4.7.4">
<h3><span class="header-section-number">4.7.4</span> Reduced model</h3>
<pre class="r"><code>plsn3_lm &lt;- lm(etch ~ cA + cC + cA:cC, plsn2)
summary(plsn3_lm)</code></pre>
<pre><code>## 
## Call:
## lm(formula = etch ~ cA + cC + cA:cC, data = plsn2)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -72.50 -15.44   2.50  18.69  66.50 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   776.06      10.42  74.458  &lt; 2e-16 ***
## cA            -50.81      10.42  -4.875 0.000382 ***
## cC            153.06      10.42  14.685 4.95e-09 ***
## cA:cC         -76.81      10.42  -7.370 8.62e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 41.69 on 12 degrees of freedom
## Multiple R-squared:  0.9608, Adjusted R-squared:  0.9509 
## F-statistic: 97.91 on 3 and 12 DF,  p-value: 1.054e-08</code></pre>
<p>Adjusted R² has improved! Clearly, removing the nonsignificant terms from the full model has produced a final model that is likely to function more effectively as a predictor of new data!</p>
</div>
<div id="doe-plots-1" class="section level3" number="4.7.5">
<h3><span class="header-section-number">4.7.5</span> DoE plots</h3>
<pre class="r"><code># Main effect of A
ggplot(plsn, aes(x = A, y = etch)) +
  geom_boxplot()</code></pre>
<p><img src="IndustRialds_files/figure-html/plsn_doe-fig-1.png" width="672" /></p>
<pre class="r"><code># Interaction gap - power
with(plsn, interaction.plot(A, C, etch, type = &quot;b&quot;))</code></pre>
<p><img src="IndustRialds_files/figure-html/plsn_doe-fig-2.png" width="672" /></p>
<pre class="r"><code># The same with ggplot
ggplot(plsn, aes(x = A, y = etch, fill = C)) +
  geom_boxplot()</code></pre>
<p><img src="IndustRialds_files/figure-html/plsn_doe-fig-3.png" width="672" /></p>
<pre class="r"><code># Reversed gap - power
with(plsn, interaction.plot(C, A, etch, type = &quot;b&quot;))</code></pre>
<p><img src="IndustRialds_files/figure-html/plsn_doe-fig-4.png" width="672" /></p>
<pre class="r"><code># The same with ggplot
ggplot(plsn2, aes(x = C, y = etch, fill = A)) +
  geom_boxplot()</code></pre>
<p><img src="IndustRialds_files/figure-html/plsn_doe-fig-5.png" width="672" />
The AC interaction is larger than the main effect of A.</p>
</div>
</div>
<p style="text-align: center;">
<a href="4-6-the-22-factorial-design.html"><button class="btn btn-default">Previous</button></a>
<a href="4-8-the-general-2k-design.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

</body>
</html>
